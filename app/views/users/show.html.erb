<div class="main-content">
<p style="color: green"><%= notice %></p>

<%= render @user %>

<div>
  <%= link_to "Edit my profile", edit_user_registration_path(current_user) %>
  <% link_to "Back to users", users_path %>
  <%= button_to "Destroy this user", @user, method: :delete %>
</div>
</div>
<div id='map'></div>

<script>
var longitudeMap = JSON.parse("<%= j @user[:longitude]%>")
var latitudeMap = JSON.parse("<%= j @user[:latitude]%>")
mapboxgl.accessToken = 'pk.eyJ1Ijoia2Vsenp6ZXIiLCJhIjoiY2wzMXVxNjk4MGZxcjNpb2pxd3lqczRyaiJ9.IvHxJFJQDY5yoISmeC5Low';
var map = new mapboxgl.Map({
container: 'map', // container ID
style: 'mapbox://styles/mapbox/streets-v11', // style URL
center: [latitudeMap, longitudeMap], // starting position [lng, lat]
zoom: 11 // starting zoom
});

// map.on('style.load', function() {
// map.on('click', function(e) {
// var coordinates = e.lngLat;
// var coordinatesLongitude = coordinates.lng;
// var coordinatesLatitude = coordinates.lat;
// document.querySelector('#user_latitude').value = coordinatesLongitude;
// document.querySelector('#user_longitude').value = coordinatesLatitude;
// console.log(coordinates)



var marker_test = new mapboxgl.Marker()
.setLngLat([latitudeMap, longitudeMap])
.addTo(map);
marker_test.togglePopup(); 
// Initialize the geolocate control.
// var geolocate = new mapboxgl.GeolocateControl({
//   positionOptions: {
//     enableHighAccuracy: true
//   },
//   trackUserLocation: true
// });

// Add the control to the map.
// map.addControl(new mapboxgl.NavigationControl());
// map.addControl(geolocate);
// geolocate.on('geolocate', function(e) {
//   document.querySelector('#user_latitude').value = e.coords.latitude;
// document.querySelector('#user_longitude').value = e.coords.longitude;
// });
// })
// })
</script>
